# OVAL_app
Вопрос 1: Провести частичный анализ OVAL файла от компании RHEL([https://www.redhat.com/security/data/oval/v2/RHEL8/rhel-8.oval.xml.bz2](https://www.redhat.com/security/data/oval/v2/RHEL8/rhel-8.oval.xml.bz2)) на первых 3 уязвимостях (патчах).

OVAL специальный язык разметки на базе xml, который используется для описания уязвимостей(патчей)и необходимых для их обнаружения проверок. Данный файл содержит описания различных патчей для систем на базе Red Hat Linux. В описаниях содержаться критерии, который представляет собой набор различных тестов в виде логического выражения, для проверки наличия условий для возможности установить патч. Основные объекты в файле это: generator, defentions, tests, objects, states и variabels. Defentions содержит объекты класса defention, где храниться описание патча.

Вопрос 2: Описать текстом объекты, которые были найдены и для чего они используются.

1. oval_defintions содержит описание схем и неймспейсов. Корень файла, нужен для задания тегов, определения обязательных тегов.
	2. generator. Автоматически генерируется. Содержит краткую информацию о документе, имя, версии, дата создания документа
	3. defentions. объект содержащий список определений узявимостей(патчей). В него входит объект defention
		1. defention. Определение объединяет в себя различные тесты OVAL файла с помощью ссылок на tests и задаёт критерии успешного выполнения тестов с помощью логических выражений. Содержит также метаданные рассматриваемой уязвимости для анализа.
			1. metadata. Метаданные уязвимости. Нужен для наглядного описания правила.
				1. title - титульник
				2. affected - информация на какую систему (ОС)идёт воздействие
				3. reference - ссылка на базу знаний уязвимостей(CVE, RHBA)
				4. description - описание
				5. advisory - информация от RedHat по уязвимости
					1. severity - оценка критичности уязвимости
					2. rights - лицензионные права
					3. issued - дата публикации уязвимости
					4. updated - дата последнего обновления информации по уязвимости
					5. cve - определение уязвимости на основе CVE + ссылка
					6. bugzilla - определение уязвимости на основе bugzilla + ссылка
					7. affected_cpe_list - список уязвимых компонентов
			2. criteria - критерии в определении описывают что должно быть протестировано в системе. Все критерии объединяется в логическое выражение с помощью операторов AND, OR
				1. criterion - содержит ссылку на конкретный test_id, определенный в объекте test в параметре test_ref. Параметр comment содержит краткое описание теста.
	4. tests - Тест на языке OVAL используется для проверки значений указанных атрибутов, относящихся к данному объекту. Структура теста OVAL просто объединяет ссылку на данный объект(object) и ссылку на состояние(state), которое мы хотим проверить.
		1. red-def:rpminfo_test или red-def:rpmverifyfile_test - содержит уникальный идентификатор теста, комментарий. С помощью атрибута check определяется соответствие между объектом и состоянием
			1. red-def:object - ссылка на уникальный объект
			2. red-def:state - ссылка на уникальное состояние
	5. objects - содержит определение объектов для проверки и их идентификаторы. Необходимо для определения что нужно тестировать.
	6. states - содержит необходимое состояние для объекта и их идентификаторы, чтобы тест считался True. Нужен для определения какое состояние должно быть у объекта, либо его значение.
	7. variables - набор дополнительных переменных

Вопрос 3: В рамках каждого определения уязвимости, есть критерии по ее выявлению:
какие из критериев на ваш взгляд лишние?

Данный файл содержит определения патчей для исправления уязвимостей систем RedHat Linux. Соответственно в определениях присутствуют критерии для обновления, которые проверяют в системе качестве ОС используется RHEL, а также содержит ли обновляемые пакеты программ ключи для подписей RedHat (Например: criterion comment="cloud-init is signed with Red Hat redhatrelease2 key). В то же время причисленным в файле уязвимостям могут быть подвержены и другие системы, не на базе RedHat (на базе Debian например.) Поэтому нам необходимы критерии, которые проверяют версии уязвимых пакетов, чтобы определить наличие уязвимости в системе. Поэтому есть смысл убрать следующие критерии:

```
<criterion comment="Red Hat Enterprise Linux must be installed" test_ref="oval:com.redhat.rhba:tst:20191992005"/>
<criterion comment="Red Hat Enterprise Linux 8 is installed" test_ref="oval:com.redhat.rhba:tst:20191992003"/>
<criterion comment="Red Hat CoreOS 4 is installed" test_ref="oval:com.redhat.rhba:tst:20191992004"/>
<criterion comment="Module virt:rhel is enabled" test_ref="oval:com.redhat.rhba:tst:20192715195"/>
# Этот критерий отнситься птачу для закрытия узвимости CVE-2019-14378, которой подвержен эмулятор QEMU. Данный критерий нужен для проверки возможномсти обновления на RHEL, но для опрдления наличия уязвимости QEMU на других дистрибутивах этот критерий будет только мешать.
<criterion comment="Module virt-devel:rhel is enabled" test_ref="oval:com.redhat.rhba:tst:20192715252"/> # Аналогично
```
Также убираем критерии связанные с ключами Red Hat redhatrelease2 key

Вопрос 4: Предложить и кратко описать свой вариант по упрощению формата для
описания уязвимости вместе с проверками.

Данный формат можно упростить следующим образом. Во-первых, если убрать вышеназванные критерии из определений, то мы упростим сами логические выражения, что упростит анализ. Во-вторых, нужно объединить критерии с связанными с ними тестами, и соответственно связанными с ними объектами и состояниями, чтобы все было в одном месте. В третьих, оставить из метаданных информацию, касающихся только уязвимостей. Таким образом мы формируем объект Vulnerability, который определяет проверки для наличия уязвимости и информацию по ней. Парсер формирует это объект и переводит его в JSON формат и возвращает JSON файл.

Вопрос 5: Смотри приложение.
Использование: запустить программу с указав путь для файла OVAL и путь для выходного файла через флаги -f и -o соотвственною
Пример: Пример: oval_parser.py -f input.xml -o output.json
На данный момент прасит опрделения только 3 опредлений.
